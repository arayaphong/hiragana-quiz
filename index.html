<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢ AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .table-container table {
            border-collapse: collapse;
            margin: 0 auto;
        }

        .table-container th,
        .table-container td {
            border: 1px solid #e2e8f0;
            padding: 0.75rem;
            min-width: 60px;
            text-align: center;
        }

        .table-container tr {
            cursor: pointer;
        }


        .choice-button,
        .ai-button {
            transition: all 0.2s ease-in-out;
        }

        .choice-button:hover,
        .ai-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .choice-button:active,
        .ai-button:active {
            transform: translateY(0);
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
        }

        #aiHelpModalContentWrapper::-webkit-scrollbar {
            width: 8px;
        }

        #aiHelpModalContentWrapper::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        #aiHelpModalContentWrapper::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }

        #aiHelpModalContentWrapper::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #6366f1;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        #aiHelpModalContent h1,
        #aiHelpModalContent h2,
        #aiHelpModalContent h3 {
            font-weight: bold;
            margin-top: 0.75em;
            margin-bottom: 0.25em;
        }

        #aiHelpModalContent h1 { font-size: 1.5em; }
        #aiHelpModalContent h2 { font-size: 1.25em; }
        #aiHelpModalContent h3 { font-size: 1.1em; }
        #aiHelpModalContent p { margin-bottom: 0.5em; }
        #aiHelpModalContent ul,
        #aiHelpModalContent ol {
            margin-left: 1.5em;
            margin-bottom: 0.5em;
            list-style-position: outside;
        }
        #aiHelpModalContent ul { list-style-type: disc; }
        #aiHelpModalContent ol { list-style-type: decimal; }
        #aiHelpModalContent strong { font-weight: bold; }
        #aiHelpModalContent em { font-style: italic; }
        #aiHelpModalContent code {
            background-color: #f3f4f6;
            padding: 0.1em 0.3em;
            border-radius: 0.25rem;
            font-family: monospace;
        }
        #aiHelpModalContent pre {
            background-color: #f3f4f6;
            padding: 0.5em;
            border-radius: 0.375rem;
            overflow-x: auto;
            margin-bottom: 0.5em;
        }
        #aiHelpModalContent pre code {
            padding: 0;
            background-color: transparent;
        }

    </style>
</head>

<body
    class="bg-gradient-to-br from-sky-100 to-indigo-200 min-h-screen flex flex-col items-center justify-center p-4 text-gray-800">
    <div class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl w-full max-w-2xl">
        <header class="mb-6 sm:mb-8 text-center">
            <h1 class="text-3xl sm:text-4xl font-bold text-indigo-600">‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞</h1>
            <p class="text-gray-600 mt-2">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å AI!</p>
        </header>

        <div class="table-container">
            <table class="w-full rounded-lg overflow-hidden shadow-md">
                <thead class="bg-indigo-500 text-white">
                    <tr>
                        <th class="p-3">‡∏™‡∏£‡∏∞</th>
                        <th class="p-3">A</th>
                        <th class="p-3">I</th>
                        <th class="p-3">U</th>
                        <th class="p-3">E</th>
                        <th class="p-3">O</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <tr onclick="selectRow('k')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">K</td>
                        <td class="p-3">„Åã (ka)</td>
                        <td class="p-3">„Åç (ki)</td>
                        <td class="p-3">„Åè (ku)</td>
                        <td class="p-3">„Åë (ke)</td>
                        <td class="p-3">„Åì (ko)</td>
                    </tr>
                    <tr onclick="selectRow('s')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">S</td>
                        <td class="p-3">„Åï (sa)</td>
                        <td class="p-3">„Åó (shi)</td>
                        <td class="p-3">„Åô (su)</td>
                        <td class="p-3">„Åõ (se)</td>
                        <td class="p-3">„Åù (so)</td>
                    </tr>
                    <tr onclick="selectRow('t')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">T</td>
                        <td class="p-3">„Åü (ta)</td>
                        <td class="p-3">„Å° (chi)</td>
                        <td class="p-3">„Å§ (tsu)</td>
                        <td class="p-3">„Å¶ (te)</td>
                        <td class="p-3">„Å® (to)</td>
                    </tr>
                    <tr onclick="selectRow('n')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">N</td>
                        <td class="p-3">„Å™ (na)</td>
                        <td class="p-3">„Å´ (ni)</td>
                        <td class="p-3">„Å¨ (nu)</td>
                        <td class="p-3">„Å≠ (ne)</td>
                        <td class="p-3">„ÅÆ (no)</td>
                    </tr>
                    <tr onclick="selectRow('h')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">H</td>
                        <td class="p-3">„ÅØ (ha)</td>
                        <td class="p-3">„Å≤ (hi)</td>
                        <td class="p-3">„Åµ (fu)</td>
                        <td class="p-3">„Å∏ (he)</td>
                        <td class="p-3">„Åª (ho)</td>
                    </tr>
                    <tr onclick="selectRow('m')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">M</td>
                        <td class="p-3">„Åæ (ma)</td>
                        <td class="p-3">„Åø (mi)</td>
                        <td class="p-3">„ÇÄ (mu)</td>
                        <td class="p-3">„ÇÅ (me)</td>
                        <td class="p-3">„ÇÇ (mo)</td>
                    </tr>
                    <tr onclick="selectRow('y')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">Y</td>
                        <td class="p-3">„ÇÑ (ya)</td>
                        <td class="p-3 text-gray-400">-</td> <td class="p-3">„ÇÜ (yu)</td>
                        <td class="p-3 text-gray-400">-</td> <td class="p-3">„Çà (yo)</td>
                    </tr>
                    <tr onclick="selectRow('r')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">R</td>
                        <td class="p-3">„Çâ (ra)</td>
                        <td class="p-3">„Çä (ri)</td>
                        <td class="p-3">„Çã (ru)</td>
                        <td class="p-3">„Çå (re)</td>
                        <td class="p-3">„Çç (ro)</td>
                    </tr>
                    <tr onclick="selectRow('w')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">W</td>
                        <td class="p-3">„Çè (wa)</td>
                        <td class="p-3 text-gray-400">-</td> <td class="p-3 text-gray-400">-</td> <td class="p-3 text-gray-400">-</td> <td class="p-3">„Çí (wo)</td>
                    </tr>
                    <tr onclick="selectRow('ns')" class="hover:bg-indigo-50 transition-colors duration-150">
                        <td class="font-medium text-indigo-700 p-3">Ns</td>
                        <td class="p-3 text-gray-400">-</td> <td class="p-3 text-gray-400">-</td> <td class="p-3">„Çì (n)</td>
                        <td class="p-3 text-gray-400">-</td> <td class="p-3 text-gray-400">-</td> </tr>
                </tbody>
            </table>
        </div>

        <div class="game hidden mt-6 sm:mt-8">
            <div id="questionArea" class="mb-6 p-4 bg-indigo-50 rounded-lg text-center">
                <p class="text-xl sm:text-2xl font-semibold text-indigo-700" id="questionText">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£: <span class="text-4xl sm:text-5xl font-bold" id="hiraganaCharacter"></span>?</p>
            </div>

            <div id="choicesArea" class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-6">
                </div>

            <div id="scoreArea" class="text-lg font-medium text-center mb-4">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="currentScore"
                    class="font-bold text-indigo-600">0</span> / <span id="totalQuestionsInQuiz"
                    class="font-bold text-indigo-600">0</span></div>

            <div id="messageArea" class="min-h-[2.5em] mb-6 text-center">
                </div>

            <div id="aiHelpSection" class="hidden mt-4 p-4 border-t border-gray-200 text-center">
                <p class="mb-3 text-gray-700">‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö <strong id="aiHelpCharReading"
                        class="text-indigo-600"></strong>?</p>
                <div class="flex flex-col sm:flex-row justify-center gap-3">
                    <button id="getMnemonicButton" onclick="getAIDrivenHelp('mnemonic')"
                        class="ai-button w-full sm:w-auto bg-teal-500 hover:bg-teal-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-opacity-50">‚ú®
                        ‡∏£‡∏±‡∏ö‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥</button>
                    <button id="getFactButton" onclick="getAIDrivenHelp('fact')"
                        class="ai-button w-full sm:w-auto bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50">‚ú®
                        ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</button>
                </div>
            </div>

            <div class="flex flex-col sm:flex-row justify-center items-center gap-3 sm:gap-4 mt-6">
                <button id="nextQuestionButton" onclick="nextQuestion()"
                    class="w-full sm:w-auto bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50 choice-button">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                <button onclick="resetGame()"
                    class="w-full sm:w-auto bg-gray-500 hover:bg-gray-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 choice-button">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà</button>
            </div>
        </div>

        <div id="gameOverModal"
            class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 hidden z-50">
            <div class="bg-white p-8 rounded-xl shadow-2xl text-center max-w-md w-full">
                <h2 id="gameOverTitle" class="text-2xl sm:text-3xl font-bold text-indigo-600 mb-4">‡∏à‡∏ö‡πÄ‡∏Å‡∏°!</h2>
                <p id="gameOverMessage" class="text-lg mb-6">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ <span id="finalScore"
                        class="font-bold">0</span>/<span id="finalTotal" class="font-bold">0</span>.</p>
                <button onclick="closeModalAndReset()"
                    class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50 choice-button">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
            </div>
        </div>

        <div id="aiHelpModal"
            class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 hidden z-50">
            <div class="bg-white p-6 rounded-xl shadow-2xl max-w-lg w-full">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="aiHelpModalTitle" class="text-xl font-semibold text-indigo-600">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ AI</h3>
                    <button onclick="closeAIHelpModal()"
                        class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <div id="aiHelpModalContentWrapper" class="max-h-[60vh] overflow-y-auto">
                    <div id="aiHelpModalLoader" class="loader hidden"></div> <div id="aiHelpModalContent" class="text-gray-700 space-y-2">
                        </div>
                </div>
                <button onclick="closeAIHelpModal()"
                    class="mt-6 w-full bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>

    </div> <script>
        const hiraganaData = {
            k: ['„Åã (ka)', '„Åç (ki)', '„Åè (ku)', '„Åë (ke)', '„Åì (ko)'],
            s: ['„Åï (sa)', '„Åó (shi)', '„Åô (su)', '„Åõ (se)', '„Åù (so)'],
            t: ['„Åü (ta)', '„Å° (chi)', '„Å§ (tsu)', '„Å¶ (te)', '„Å® (to)'],
            n: ['„Å™ (na)', '„Å´ (ni)', '„Å¨ (nu)', '„Å≠ (ne)', '„ÅÆ (no)'],
            h: ['„ÅØ (ha)', '„Å≤ (hi)', '„Åµ (fu)', '„Å∏ (he)', '„Åª (ho)'],
            m: ['„Åæ (ma)', '„Åø (mi)', '„ÇÄ (mu)', '„ÇÅ (me)', '„ÇÇ (mo)'],
            y: ['„ÇÑ (ya)', null, '„ÇÜ (yu)', null, '„Çà (yo)'],
            r: ['„Çâ (ra)', '„Çä (ri)', '„Çã (ru)', '„Çå (re)', '„Çç (ro)'],
            w: ['„Çè (wa)', null, null, null, '„Çí (wo)'],
            ns: [null, null, '„Çì (n)', null, null]
        };

        let selectedRowKey = null;
        let currentQuestionsSet = [];
        let currentQuestionIndex = 0;
        let score = 0;
        const totalQuestionsPerQuiz = 10;
        let currentHiraganaForAI = null;

        const tableContainer = document.querySelector('.table-container');
        const gameContainer = document.querySelector('.game');
        const questionTextElement = document.getElementById('questionText');
        const hiraganaCharacterElement = document.getElementById('hiraganaCharacter');
        const choicesArea = document.getElementById('choicesArea');
        const currentScoreElement = document.getElementById('currentScore');
        const totalQuestionsInQuizElement = document.getElementById('totalQuestionsInQuiz');
        const messageArea = document.getElementById('messageArea');
        const nextQuestionButton = document.getElementById('nextQuestionButton');

        const gameOverModal = document.getElementById('gameOverModal');
        const gameOverTitle = document.getElementById('gameOverTitle');
        const gameOverMessage = document.getElementById('gameOverMessage');
        const finalScoreElement = document.getElementById('finalScore');
        const finalTotalElement = document.getElementById('finalTotal');

        const aiHelpSection = document.getElementById('aiHelpSection');
        const aiHelpCharReadingElement = document.getElementById('aiHelpCharReading');
        const aiHelpModal = document.getElementById('aiHelpModal');
        const aiHelpModalTitle = document.getElementById('aiHelpModalTitle');
        const aiHelpModalContent = document.getElementById('aiHelpModalContent');
        const aiHelpModalLoader = document.getElementById('aiHelpModalLoader');


        const toggleVisibility = (element, show) => {
            if (element) {
                element.classList.toggle('hidden', !show);
            } else {
                console.error("‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô null ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ú‡∏¥‡∏î‡πÉ‡∏ô ID ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏•‡∏≤‡∏™ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô DOM ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å");
            }
        };

        const shuffleArray = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        };

        const parseHiraganaString = (hiraganaString) => {
            if (!hiraganaString || typeof hiraganaString !== 'string') return null;
            const match = hiraganaString.match(/^(\S+)\s\((\S+)\)$/);
            return match ? { char: match[1], reading: match[2] } : null;
        };


        const selectRow = (rowKey) => {
            selectedRowKey = rowKey;
            const rowData = hiraganaData[rowKey].filter(item => item !== null);

            if (rowData.length === 0) {
                showMessage("‡πÅ‡∏ñ‡∏ß‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡πÉ‡∏´‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö", "text-red-500", 3000);
                return;
            }

            currentQuestionsSet = [];
            while (currentQuestionsSet.length < totalQuestionsPerQuiz) {
                currentQuestionsSet.push(...rowData);
            }
            currentQuestionsSet = currentQuestionsSet.slice(0, totalQuestionsPerQuiz);
            shuffleArray(currentQuestionsSet);

            currentQuestionIndex = 0;
            score = 0;
            updateScoreDisplay();
            totalQuestionsInQuizElement.textContent = currentQuestionsSet.length;

            toggleVisibility(tableContainer, false);
            toggleVisibility(gameContainer, true);
            toggleVisibility(nextQuestionButton, false);
            toggleVisibility(aiHelpSection, false);
            messageArea.textContent = '';
            displayQuestion();
        };

        const displayQuestion = () => {
            if (currentQuestionIndex >= currentQuestionsSet.length) {
                endGame();
                return;
            }

            const questionString = currentQuestionsSet[currentQuestionIndex];
            const parsedQuestion = parseHiraganaString(questionString);

            if (!parsedQuestion) {
                console.error("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:", questionString);
                showMessage("‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ç‡πâ‡∏≤‡∏°", "text-red-500", 3000);
                currentQuestionIndex++;
                setTimeout(displayQuestion, 50);
                return;
            }

            currentHiraganaForAI = parsedQuestion;
            hiraganaCharacterElement.textContent = parsedQuestion.char;
            questionTextElement.childNodes[0].nodeValue = `‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£: `;

            generateChoices(parsedQuestion);
            toggleVisibility(nextQuestionButton, false);
            toggleVisibility(aiHelpSection, false);
            messageArea.textContent = '';
        };

        const generateChoices = (correctParsedItem) => {
            choicesArea.innerHTML = '';
            let choices = [correctParsedItem.reading];

            const allPossibleReadingsInRow = hiraganaData[selectedRowKey]
                .filter(item => item !== null)
                .map(item => parseHiraganaString(item)?.reading)
                .filter(reading => reading && reading !== correctParsedItem.reading);

            shuffleArray(allPossibleReadingsInRow);

            for (let i = 0; choices.length < 4 && i < allPossibleReadingsInRow.length; i++) {
                if (!choices.includes(allPossibleReadingsInRow[i])) {
                    choices.push(allPossibleReadingsInRow[i]);
                }
            }

            if (choices.length < 2 && Object.keys(hiraganaData).length > 1) {
                const otherReadings = [];
                for (const key in hiraganaData) {
                    if (key !== selectedRowKey) {
                        hiraganaData[key].forEach(item => {
                            const parsed = parseHiraganaString(item);
                            if (parsed && parsed.reading !== correctParsedItem.reading && !choices.includes(parsed.reading)) {
                                otherReadings.push(parsed.reading);
                            }
                        });
                    }
                }
                shuffleArray(otherReadings);
                for (let i = 0; choices.length < 4 && i < otherReadings.length; i++) {
                     if (!choices.includes(otherReadings[i])) choices.push(otherReadings[i]);
                }
            }
            shuffleArray(choices);

            choices.forEach(reading => {
                const button = document.createElement('button');
                button.textContent = reading;
                button.className = "w-full choice-button bg-white hover:bg-indigo-100 text-indigo-700 font-semibold py-3 px-4 border border-indigo-300 rounded-lg shadow-sm";
                button.onclick = () => checkAnswer(reading, correctParsedItem.reading);
                choicesArea.appendChild(button);
            });
        };

        const checkAnswer = (selectedReading, correctReading) => {
            choicesArea.querySelectorAll('button').forEach(button => button.disabled = true);

            if (selectedReading === correctReading) {
                score++;
                showMessage("‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!", "text-green-500 font-bold", 1500);
            } else {
                showMessage(`‡∏ú‡∏¥‡∏î! ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: ${correctReading}`, "text-red-500 font-bold", 2000);
            }
            updateScoreDisplay();
            aiHelpCharReadingElement.textContent = `${currentHiraganaForAI.char} (${currentHiraganaForAI.reading})`;
            toggleVisibility(aiHelpSection, true);
            toggleVisibility(nextQuestionButton, true); // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° "‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ"
        };

        const nextQuestion = () => {
            currentQuestionIndex++;
            displayQuestion();
        };

        const updateScoreDisplay = () => {
            currentScoreElement.textContent = score;
        };

        const showMessage = (text, className, duration) => {
            messageArea.textContent = text;
            messageArea.className = `min-h-[2.5em] mb-6 text-center text-lg ${className}`;
            if (duration) {
                setTimeout(() => {
                    if (messageArea.textContent === text) {
                        messageArea.textContent = '';
                        messageArea.className = 'min-h-[2.5em] mb-6 text-center';
                    }
                }, duration);
            }
        };

        const endGame = () => {
            finalScoreElement.textContent = score;
            finalTotalElement.textContent = currentQuestionsSet.length;
            let msg = `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ ${score}/${currentQuestionsSet.length}.`;

            if (score === currentQuestionsSet.length) {
                gameOverTitle.textContent = "üéâ ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! üéâ";
                msg += " ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å!";
            } else if (score >= currentQuestionsSet.length * 0.7) {
                gameOverTitle.textContent = "üëç ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! üëç";
                msg += " ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å!";
            } else {
                gameOverTitle.textContent = "‡∏à‡∏ö‡πÄ‡∏Å‡∏°!";
                msg += " ‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏∞!";
            }

            gameOverMessage.childNodes[0].nodeValue = msg;
            toggleVisibility(gameOverModal, true);
            toggleVisibility(aiHelpSection, false);
        };

        const closeModalAndReset = () => {
            toggleVisibility(gameOverModal, false);
            resetGame();
        };

        const resetGame = () => {
            selectedRowKey = null;
            currentQuestionsSet = [];
            currentQuestionIndex = 0;
            score = 0;
            currentHiraganaForAI = null;
            updateScoreDisplay();

            toggleVisibility(gameContainer, false);
            toggleVisibility(tableContainer, true);
            toggleVisibility(gameOverModal, false);
            toggleVisibility(aiHelpSection, false);

            choicesArea.innerHTML = '';
            messageArea.textContent = '';
            messageArea.className = 'min-h-[2.5em] mb-6 text-center';
            hiraganaCharacterElement.textContent = '';
            questionTextElement.childNodes[0].nodeValue = `‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£: `;
            console.log("‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡πâ‡∏ß");
        };

        const openAIHelpModal = (title) => {
            aiHelpModalTitle.textContent = title;
            aiHelpModalContent.innerHTML = '';
            toggleVisibility(aiHelpModalLoader, true);
            toggleVisibility(aiHelpModal, true);
        };

        const closeAIHelpModal = () => {
            toggleVisibility(aiHelpModal, false);
            toggleVisibility(aiHelpModalLoader, false);
            aiHelpModalContent.innerHTML = '';
        };

        async function translateToThaiExplicitly(textToTranslate) {
            if (!textToTranslate || textToTranslate.trim() === "") {
                return "";
            }

            const translationPrompt = `Translate the following text accurately and naturally into Thai. Preserve Markdown formatting if present. Text to translate: "${textToTranslate}" Respond ONLY with the translated Thai text.`;

            try {
                let translationChatHistory = [{ role: "user", parts: [{ text: translationPrompt }] }];
                const payload = { contents: translationChatHistory };
                const apiKey = ""; // API key ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏î‡∏¢‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° Canvas ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("Gemini Translation API Error:", errorData);
                    return `(‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•) ${textToTranslate}`;
                }

                const translationResult = await response.json();
                console.log("‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å API ‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•:", translationResult);

                if (translationResult.candidates && translationResult.candidates.length > 0 &&
                    translationResult.candidates[0].content && translationResult.candidates[0].content.parts &&
                    translationResult.candidates[0].content.parts.length > 0) {
                    return translationResult.candidates[0].content.parts[0].text;
                } else {
                    console.error("‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á API ‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏≤‡∏î‡∏Ñ‡∏¥‡∏î:", translationResult);
                    return `(‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•) ${textToTranslate}`;
                }
            } catch (error) {
                console.error("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•:", error);
                return `(‡∏Ç‡πâ‡∏≠‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•) ${textToTranslate}`;
            }
        }

        const getAIDrivenHelp = async (helpType) => {
            if (!currentHiraganaForAI) {
                showMessage("‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ AI", "text-red-500", 2000);
                return;
            }

            const { char, reading } = currentHiraganaForAI;
            let initialPrompt; 
            let modalTitle;

            if (helpType === 'mnemonic') {
                initialPrompt = `‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏ï‡∏±‡∏ß '${char}' ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏ß‡πà‡∏≤ '${reading}', ‡∏Ç‡∏≠‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏à‡∏î‡∏à‡∏≥‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏ä‡πâ Markdown ‡πÅ‡∏•‡∏∞‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô`;
                modalTitle = `‚ú® ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${char} (${reading})`;
            } else if (helpType === 'fact') {
                initialPrompt = `‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏ï‡∏±‡∏ß '${char}' ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏ß‡πà‡∏≤ '${reading}', ‡πÇ‡∏õ‡∏£‡∏î‡∏ö‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡πÄ‡∏ó‡πá‡∏à‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ (‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏±‡∏ô‡∏à‡∏¥‡∏ï‡∏±‡∏ß‡πÉ‡∏î), ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ '${char}' ‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡∏Ç‡∏≠‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ‡πÇ‡∏õ‡∏£‡∏î‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô Markdown ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢`;
                modalTitle = `‚ú® ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö ${char} (${reading})`;
            } else {
                console.error("‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ AI:", helpType);
                return;
            }

            openAIHelpModal(modalTitle); 

            try {
                let initialChatHistory = [{ role: "user", parts: [{ text: initialPrompt }] }];
                const initialPayload = { contents: initialChatHistory };
                const apiKey = ""; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const initialResponse = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(initialPayload)
                });

                if (!initialResponse.ok) { 
                    const errorData = await initialResponse.json();
                    console.error("‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î Gemini API ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô:", errorData);
                    throw new Error(`‡∏Ñ‡∏≥‡∏Ç‡∏≠ API ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ${initialResponse.status}: ${errorData.error?.message || '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å'}`);
                }

                const initialResult = await initialResponse.json();
                console.log("‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå API ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô:",initialResult); 

                toggleVisibility(aiHelpModalLoader, false); 

                if (initialResult.candidates && initialResult.candidates.length > 0 &&
                    initialResult.candidates[0].content && initialResult.candidates[0].content.parts &&
                    initialResult.candidates[0].content.parts.length > 0) {
                    
                    const textFromInitialApi = initialResult.candidates[0].content.parts[0].text;
                    
                    toggleVisibility(aiHelpModalLoader, true);
                    const finalTextToDisplay = await translateToThaiExplicitly(textFromInitialApi);
                    toggleVisibility(aiHelpModalLoader, false);

                    aiHelpModalContent.innerHTML = marked.parse(finalTextToDisplay);

                } else {
                    console.error("‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á API ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏≤‡∏î‡∏Ñ‡∏¥‡∏î:", initialResult);
                    aiHelpModalContent.innerHTML = marked.parse("‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏à‡∏≤‡∏Å AI ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡πÑ‡∏ß‡πâ");
                }
            } catch (error) { 
                console.error("‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ AI:", error);
                toggleVisibility(aiHelpModalLoader, false); 
                aiHelpModalContent.innerHTML = marked.parse(`‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏Ç‡∏ì‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠: **${error.message}** ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á`);
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            console.log("‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Æ‡∏¥‡∏£‡∏≤‡∏á‡∏≤‡∏ô‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ AI ‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ñ‡∏ß‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö");
        });

    </script>
</body>

</html>
